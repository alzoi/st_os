# Лекция № 1
## Ссылки
https://www.youtube.com/watch?v=I5Cv_cvTaw8&list=PL8_dzIbSKnugf2XGXJE5AMU_qkxOEIz7V&index=1&t=247s  

## Загрузка ОС
Для обращения к байтам, расположенным на жестком диске, необходимо использовать библиотечные функции. Получение данных выполняется через драйвер устройства. К оперативной памяти можно обращаться напрямую по адресу байта, например, используя массивы.
![image](https://github.com/alzoi/st_os/assets/20499566/1f2fca4b-017b-49e3-964d-0a7240172714)

## Ассемблер
https://godbolt.org/  
![image](https://github.com/alzoi/st_os/assets/20499566/20273a60-b6dc-4c7f-9d49-1d61f309490e)

## Виртуальная память
https://wiki.osdev.org/Paging  
Программа оперирует виртальными адресами (или говорят ещё линейными, последовательными адресами), процессор получает виртуальный адрес, направляет его в устройство MMU и получает соответствующий физический адрес страницы памяти, которая содержит 4 КБ данных (2^12 = 4096 Байт).
Смещение в младших битах виртального адреса указывает на смещение физического адреса в выбранной странице памяти.  

Одна запись в таблицых Page Directory (каталог страниц) и Page Table (таблица страниц) занимает 4 Байта (32 бита - машинное слово для архитектуры процессора x32 или ещё указывают x86).  
То есть в каталоге 4096 / 4 = 1024 записи, значит мы можем создать 1024 таблицы, которые могут адресовать каждая по 1024 страниц памяти.  
Запись в таблице памяти занимает 1 Байт.  
В x32 процессорах максимальный объём адресуемой физической памяти равен  
Memory Size = Page Directory * Page Table * Page = 1024 * 1024 * 4096 = 4 294 967 296 = 4 ГБ

Страница имеет размер 4096 Байт, т.е. 2^12 Байт.  
Это означает, что страницы выравниваются по размеру, кратному 4 КБ, и что адрес страницы равен xxxxxxxxxxxxxxxxxxxx000000000000. Другими словами, адрес страницы требует на 12 бит меньше размера адресной шины (младшие 12 бит всегда 0). Для 32-битных адресов значимыми битами адреса будут старшие 20 бит их и передают по адресной шине.  
Запись каталога страниц имеет 32 бита, поэтому 2^10 из них умещаются на странице размером 4 КБ.

![image](https://github.com/alzoi/st_os/assets/20499566/b5adb4d6-e057-48ce-bb98-71772053839f)

![image](https://github.com/alzoi/st_os/assets/20499566/4bac24dc-f86a-40ca-a8d4-719e369a26bd)

![image](https://github.com/alzoi/st_os/assets/20499566/8ee54cca-d845-4513-be6a-1f2d494cfe82)  
Можно использовать страницы по 4 МБ  
![image](https://github.com/alzoi/st_os/assets/20499566/2001b8f3-770c-47d5-bb7c-ff5085034c45)

## Заготовка для разработки ядра ОС
https://wiki.osdev.org/Bare_Bones
https://wiki.osdev.org/Higher_Half_x86_Bare_Bones
